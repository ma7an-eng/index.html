<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±ÙˆØªÙŠÙ† Ø§Ù„Ø¹Ø¸Ù…Ø§Ø¡ - Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-body: #ffffff;
            --text-main: #000000;
            --text-light: #555555;
            --border: #e0e0e0;
            --accent: #000000;
            --success: #27ae60;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Cairo', sans-serif;
        }

        body {
            background-color: #f9f9f9;
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding-bottom: 80px;
        }

        .app-container {
            width: 100%;
            max-width: 600px;
            background: #ffffff;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.05);
            position: relative;
        }

        /* --- Ø§Ù„Ø±Ø£Ø³ (ØµÙˆØ± Ø´Ø®ØµÙŠØ©) --- */
        .header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid var(--border);
            background: #fff;
        }

        .avatars-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 10px;
        }

        .avatar-small {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid var(--border);
            padding: 2px;
            filter: grayscale(100%); /* Ø£Ø¨ÙŠØ¶ ÙˆØ£Ø³ÙˆØ¯ */
            transition: 0.3s;
        }
        
        /* ØªÙ„ÙˆÙŠÙ† Ø§Ù„ØµÙˆØ± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ… ÙƒÙ„Ù…Ø³Ø© Ø¬Ù…Ø§Ù„ÙŠØ© */
        .avatar-small:hover { filter: grayscale(0%); border-color: var(--accent); }

        .date-tag {
            background: #000;
            color: #fff;
            padding: 4px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: inline-block;
            margin-top: 10px;
        }

        /* --- Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… --- */
        .view-section { display: none; padding: 20px; }
        .view-section.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from {opacity:0; transform: translateY(10px);} to {opacity:1; transform: translateY(0);} }

        /* ÙƒØ§Ø±Øª Ø§Ù„Ù…Ù‡Ù…Ø© */
        .task-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 10px;
            background: #fff;
            transition: 0.2s;
        }

        .task-info h3 { font-size: 1rem; margin-bottom: 2px; }
        .task-time { font-size: 0.8rem; color: #888; display: flex; align-items: center; gap: 4px; }

        .check-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid #ccc;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: transparent;
            font-size: 1.2rem;
            transition: 0.2s;
        }
        .check-btn:hover { border-color: #000; }

        /* Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² */
        .task-card.done { background: #fcfcfc; border-color: #eee; }
        .task-card.done h3 { text-decoration: line-through; color: #bbb; }
        .task-card.done .check-btn {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        /* --- Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© (Modal) --- */
        .reward-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            z-index: 2000;
            display: none; /* Ù…Ø®ÙÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
            padding: 20px;
        }

        .reward-card {
            background: white;
            width: 100%;
            max-width: 400px;
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            animation: popUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            border-top: 5px solid var(--success);
        }

        @keyframes popUp { from {transform: scale(0.7); opacity: 0;} to {transform: scale(1); opacity: 1;} }

        .reward-img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 20px;
            border: 4px solid #f0f0f0;
        }

        .reward-quote { font-size: 1.1rem; font-weight: bold; margin-bottom: 10px; line-height: 1.6; }
        .reward-author { font-size: 0.9rem; color: #777; margin-bottom: 25px; }

        .btn-close-reward {
            background: #000;
            color: #fff;
            border: none;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }
        .btn-close-reward:hover { background: #333; }

        /* --- Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ®Ø·ÙŠØ· --- */
        .day-scroller {
            display: flex; overflow-x: auto; gap: 8px; padding-bottom: 10px; margin-bottom: 20px; scrollbar-width: none;
        }
        .day-scroller::-webkit-scrollbar { display: none; }
        
        .day-chip {
            padding: 8px 16px; background: #eee; border-radius: 20px; font-size: 0.9rem; white-space: nowrap; cursor: pointer;
        }
        .day-chip.active { background: #000; color: #fff; }

        .input-box { display: flex; gap: 10px; margin-bottom: 20px; }
        .input-box input { flex: 1; padding: 12px; border: 2px solid #eee; border-radius: 8px; }
        .btn-add { background: #000; color: #fff; border: none; padding: 0 20px; border-radius: 8px; cursor: pointer; }

        .routine-item { display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid #eee; }
        .btn-del { color: red; cursor: pointer; font-size: 0.8rem; }

        /* --- Ø§Ù„ØªÙ†Ù‚Ù„ --- */
        .nav-bar {
            position: fixed; bottom: 0; left: 0; width: 100%; background: #fff; border-top: 1px solid #eee;
            display: flex; justify-content: center; gap: 40px; padding: 15px; z-index: 100;
        }
        .nav-link { background: none; border: none; font-weight: bold; color: #aaa; cursor: pointer; font-size: 1rem; }
        .nav-link.active { color: #000; text-decoration: underline; }

    </style>
</head>
<body>

    <div class="app-container">
        
        <div class="header">
            <div class="avatars-container">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Elon_Musk_Royal_Society_%28crop2%29.jpg/220px-Elon_Musk_Royal_Society_%28crop2%29.jpg" class="avatar-small" alt="Elon">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Jeff_Bezos_at_Amazon_Spheres_Grand_Opening_in_Seattle_-_2018_%2839074799225%29_%28cropped%29.jpg/220px-Jeff_Bezos_at_Amazon_Spheres_Grand_Opening_in_Seattle_-_2018_%2839074799225%29_%28cropped%29.jpg" class="avatar-small" alt="Jeff">
            </div>
            <h1 style="font-size: 1.2rem;">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù…</h1>
            <span class="date-tag" id="headerDate">--/--</span>
        </div>

        <div id="viewToday" class="view-section active">
            <div id="tasksContainer"></div>
            <div id="emptyState" style="text-align: center; margin-top: 50px; color: #999;">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù….<br>Ø£Ø¶Ù Ø®Ø·ØªÙƒ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ ğŸ“
            </div>
        </div>

        <div id="viewPlan" class="view-section">
            <h3 style="margin-bottom: 15px;">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø±ÙˆØªÙŠÙ†</h3>
            <div class="day-scroller" id="dayScroller"></div>
            
            <div class="input-box">
                <input type="text" id="taskName" placeholder="Ø§Ù„Ù…Ù‡Ù…Ø©..">
                <input type="time" id="taskTime">
                <button class="btn-add" onclick="addTask()">+</button>
            </div>

            <div>
                <h4 style="font-size:0.9rem; color:#777; margin-bottom:10px">Ù‚Ø§Ø¦Ù…Ø© ÙŠÙˆÙ… <span id="selectedDayLabel">--</span>:</h4>
                <div id="routineContainer"></div>
            </div>
        </div>

    </div>

    <div class="reward-modal" id="rewardModal">
        <div class="reward-card">
            <h2 style="margin-bottom: 10px;">ğŸ‰ Ù…Ø°Ù‡Ù„!</h2>
            <img id="rewardImage" src="" class="reward-img">
            <p class="reward-quote" id="rewardQuote">"..."</p>
            <p class="reward-author" id="rewardAuthor">-</p>
            <button class="btn-close-reward" onclick="closeReward()">Ø§Ø³ØªÙ…Ø±Ø§Ø±</button>
        </div>
    </div>

    <div class="nav-bar">
        <button class="nav-link active" onclick="switchView('today')" id="btnToday">Ø§Ù„Ù…Ù‡Ø§Ù…</button>
        <button class="nav-link" onclick="switchView('plan')" id="btnPlan">Ø§Ù„Ø¬Ø¯ÙˆÙ„</button>
    </div>

    <script>
        // --- 1. Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
        const rewardsData = [
            {
                // Ø¥ÙŠÙ„ÙˆÙ† Ù…Ø§Ø³Ùƒ
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/34/Elon_Musk_Royal_Society_%28crop2%29.jpg/220px-Elon_Musk_Royal_Society_%28crop2%29.jpg",
                author: "Ø¥ÙŠÙ„ÙˆÙ† Ù…Ø§Ø³Ùƒ",
                quotes: [
                    "Ø¹Ù†Ø¯Ù…Ø§ ÙŠÙƒÙˆÙ† Ø´ÙŠØ¡ Ù…Ø§ Ù…Ù‡Ù…Ø§Ù‹ Ø¨Ù…Ø§ ÙÙŠÙ‡ Ø§Ù„ÙƒÙØ§ÙŠØ©ØŒ ÙØ¥Ù†Ùƒ ØªÙØ¹Ù„Ù‡ Ø­ØªÙ‰ Ù„Ùˆ ÙƒØ§Ù†Øª Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª Ø¶Ø¯Ùƒ.",
                    "Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù‡ÙŠ Ø¥Ø«Ø¨Ø§Øª Ø£Ù† Ø§Ù„Ø´ÙŠØ¡ Ù…Ù…ÙƒÙ†.",
                    "Ø£Ø¹ØªÙ‚Ø¯ Ø£Ù†Ù‡ Ù…Ù† Ø§Ù„Ù…Ù…ÙƒÙ† Ù„Ù„Ù†Ø§Ø³ Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ† Ø£Ù† ÙŠØ®ØªØ§Ø±ÙˆØ§ Ø£Ù† ÙŠÙƒÙˆÙ†ÙˆØ§ Ø§Ø³ØªØ«Ù†Ø§Ø¦ÙŠÙŠÙ†.",
                    "Ø§Ù„Ù…Ø«Ø§Ø¨Ø±Ø© Ù…Ù‡Ù…Ø© Ø¬Ø¯Ø§Ù‹. Ù„Ø§ ÙŠÙ†Ø¨ØºÙŠ Ø£Ù† ØªØ³ØªØ³Ù„Ù… Ø¥Ù„Ø§ Ø¥Ø°Ø§ Ø£Ø¬Ø¨Ø±Øª Ø¹Ù„Ù‰ Ø°Ù„Ùƒ."
                ]
            },
            {
                // Ø¬ÙŠÙ Ø¨ÙŠØ²ÙˆØ²
                img: "https://upload.wikimedia.org/wikipedia/commons/thumb/6/6c/Jeff_Bezos_at_Amazon_Spheres_Grand_Opening_in_Seattle_-_2018_%2839074799225%29_%28cropped%29.jpg/220px-Jeff_Bezos_at_Amazon_Spheres_Grand_Opening_in_Seattle_-_2018_%2839074799225%29_%28cropped%29.jpg",
                author: "Ø¬ÙŠÙ Ø¨ÙŠØ²ÙˆØ²",
                quotes: [
                    "Ø¥Ø°Ø§ Ø¶Ø§Ø¹ÙØª Ø¹Ø¯Ø¯ Ø§Ù„ØªØ¬Ø§Ø±Ø¨ Ø§Ù„ØªÙŠ ØªÙ‚ÙˆÙ… Ø¨Ù‡Ø§ Ø³Ù†ÙˆÙŠØ§Ù‹ØŒ ÙØ³ØªØ¶Ø§Ø¹Ù Ø¥Ø¨Ø¯Ø§Ø¹Ùƒ.",
                    "Ø§Ù„Ø°ÙƒØ§Ø¡ Ù‡Ùˆ Ù†Ø¹Ù…Ø©ØŒ Ø£Ù…Ø§ Ø§Ù„Ù„Ø·Ù ÙÙ‡Ùˆ Ø®ÙŠØ§Ø±.",
                    "Ø§Ø¹Ù…Ù„ Ø¨Ø¬Ø¯ØŒ Ø§Ø³ØªÙ…ØªØ¹ Ø¨ÙˆÙ‚ØªÙƒØŒ ÙˆØ§ØµÙ†Ø¹ Ø§Ù„ØªØ§Ø±ÙŠØ®.",
                    "ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ©ØŒ Ù†Ø­Ù† Ø®ÙŠØ§Ø±Ø§ØªÙ†Ø§."
                ]
            }
        ];

        const daysEn = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        const daysAr = {'Sunday': 'Ø§Ù„Ø£Ø­Ø¯', 'Monday': 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Tuesday': 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Wednesday': 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Thursday': 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Friday': 'Ø§Ù„Ø¬Ù…Ø¹Ø©', 'Saturday': 'Ø§Ù„Ø³Ø¨Øª'};

        let routine = JSON.parse(localStorage.getItem('routine_v6')) || {
            'Sunday': [], 'Monday': [], 'Tuesday': [], 'Wednesday': [], 'Thursday': [], 'Friday': [], 'Saturday': []
        };
        let history = JSON.parse(localStorage.getItem('history_v6')) || {};
        let currentPlanDay = '';

        window.onload = function() {
            const now = new Date();
            const dayName = daysEn[now.getDay()];
            document.getElementById('headerDate').innerText = `${daysAr[dayName]} | ${now.toLocaleDateString('ar-SA')}`;
            currentPlanDay = dayName;

            renderDayScroller();
            renderRoutine();
            renderToday();
        };

        // --- 2. Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² ---
        function renderToday() {
            const now = new Date();
            const dayName = daysEn[now.getDay()];
            const dateKey = now.toLocaleDateString('en-CA');
            const list = document.getElementById('tasksContainer');
            const tasks = routine[dayName] || [];

            list.innerHTML = '';
            document.getElementById('emptyState').style.display = tasks.length === 0 ? 'block' : 'none';

            tasks.sort((a, b) => (a.time || '23:59').localeCompare(b.time || '23:59'));

            let completedCount = 0;

            tasks.forEach(task => {
                const uid = `${dateKey}_${task.name}_${task.time}`;
                const isDone = history[uid] === true;
                if(isDone) completedCount++;

                const div = document.createElement('div');
                div.className = `task-card ${isDone ? 'done' : ''}`;
                div.innerHTML = `
                    <div class="task-info">
                        <h3>${task.name}</h3>
                        ${task.time ? `<span class="task-time">â° ${formatTime(task.time)}</span>` : ''}
                    </div>
                    <button class="check-btn" onclick="toggleTask('${uid}')">âœ”</button>
                `;
                list.appendChild(div);
            });

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙƒØ§Ù…Ù„ (Trigger)
            if (tasks.length > 0 && completedCount === tasks.length) {
                // Ù†Ø³ØªØ®Ø¯Ù… SetTimeout Ù„Ù†ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø±Ø£Ù‰ Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØµØ­ Ø£ÙˆÙ„Ø§Ù‹
                setTimeout(() => {
                    showReward();
                }, 500);
            }
        }

        function toggleTask(id) {
            history[id] = !history[id];
            localStorage.setItem('history_v6', JSON.stringify(history));
            renderToday();
        }

        // --- 3. Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© ---
        function showReward() {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù‡Ù„ ØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„ÙØ¹Ù„ØŸ (Ø§Ø®ØªÙŠØ§Ø±ÙŠØŒ Ù‡Ù†Ø§ Ø³Ù†Ø¬Ø¹Ù„Ù‡Ø§ ØªØ¸Ù‡Ø± ÙƒÙ„ Ù…Ø±Ø© ÙŠÙƒÙ…Ù„ ÙÙŠÙ‡Ø§)
            const randomPerson = rewardsData[Math.floor(Math.random() * rewardsData.length)];
            const randomQuote = randomPerson.quotes[Math.floor(Math.random() * randomPerson.quotes.length)];

            document.getElementById('rewardImage').src = randomPerson.img;
            document.getElementById('rewardQuote').innerText = `"${randomQuote}"`;
            document.getElementById('rewardAuthor').innerText = `- ${randomPerson.author}`;

            document.getElementById('rewardModal').style.display = 'flex';
        }

        function closeReward() {
            document.getElementById('rewardModal').style.display = 'none';
        }

        // --- 4. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ ---
        function renderDayScroller() {
            const box = document.getElementById('dayScroller');
            box.innerHTML = '';
            const todayIdx = new Date().getDay();
            const sorted = [...daysEn.slice(todayIdx), ...daysEn.slice(0, todayIdx)];

            sorted.forEach(day => {
                const chip = document.createElement('div');
                chip.className = `day-chip ${day === currentPlanDay ? 'active' : ''}`;
                chip.innerText = daysAr[day];
                chip.onclick = () => {
                    currentPlanDay = day;
                    renderDayScroller();
                    renderRoutine();
                };
                box.appendChild(chip);
            });
        }

        function renderRoutine() {
            document.getElementById('selectedDayLabel').innerText = daysAr[currentPlanDay];
            const list = document.getElementById('routineContainer');
            const tasks = routine[currentPlanDay] || [];
            list.innerHTML = '';
            
            if(tasks.length === 0) list.innerHTML = '<div style="color:#ccc; font-size:0.8rem">ÙØ§Ø±Øº</div>';

            tasks.forEach((task, idx) => {
                const div = document.createElement('div');
                div.className = 'routine-item';
                div.innerHTML = `
                    <div><strong>${task.name}</strong> <small style="color:#aaa">${formatTime(task.time)}</small></div>
                    <span class="btn-del" onclick="delTask(${idx})">Ø­Ø°Ù</span>
                `;
                list.appendChild(div);
            });
        }

        function addTask() {
            const name = document.getElementById('taskName').value.trim();
            const time = document.getElementById('taskTime').value;
            if(!name) return;

            routine[currentPlanDay].push({name, time});
            localStorage.setItem('routine_v6', JSON.stringify(routine));
            document.getElementById('taskName').value = '';
            
            renderRoutine();
            if(currentPlanDay === daysEn[new Date().getDay()]) renderToday();
        }

        function delTask(idx) {
            if(confirm('Ø­Ø°ÙØŸ')) {
                routine[currentPlanDay].splice(idx, 1);
                localStorage.setItem('routine_v6', JSON.stringify(routine));
                renderRoutine();
                if(currentPlanDay === daysEn[new Date().getDay()]) renderToday();
            }
        }

        // --- Ø£Ø¯ÙˆØ§Øª ---
        function formatTime(t) {
            if(!t) return '';
            let [h, m] = t.split(':');
            let ampm = h >= 12 ? 'Ù…' : 'Øµ';
            h = h % 12 || 12;
            return `${h}:${m} ${ampm}`;
        }

        function switchView(v) {
            document.querySelectorAll('.view-section').forEach(e => e.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(e => e.classList.remove('active'));
            
            if(v === 'today') {
                document.getElementById('viewToday').classList.add('active');
                document.getElementById('btnToday').classList.add('active');
                renderToday();
            } else {
                document.getElementById('viewPlan').classList.add('active');
                document.getElementById('btnPlan').classList.add('active');
            }
        }
    </script>
</body>
</html>
